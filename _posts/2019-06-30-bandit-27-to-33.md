---
layout: post
title:  "Bandit Levels 26 to 33 (hints first, spoilers at the end)"
date:   2019-06-30 18:00:00 -0300
categories: security, git, wargames
comments: false
---

[Over the Wire](http://overthewire.org/) has some interesting security challenges (called [wargames](overthewire.org/wargames/)). In this post I give some insights on the last levels of [Bandit](http://overthewire.org/wargames/bandit/), the introductory wargame at Over the Wire. The purpose of this post is not to spoil (although complete solutions can be found at the very end of the article), but rather to show some hints to help those of you that are stuck in a specific level. I will not include previous levels here because most of them are already covered [here](https://bresleveloper.blogspot.com/2018/05/overthewire-bandit-walkthrough-just.html).

<!--more-->


Don't read all the hints at once. Try to take a look at each hint separetly, go back to the challenge and try to go on by yourself. If you feel you need a little bit more help, come back and read another hint.


### Hints 26 -> 27


So assuming you successfully logged in level 26 the next password should be quite straightforward:

1. Figure out what the file `bandit27-do` does.

2. Try to execute `bandit27-do`, what is the output?

3. `bandit27-do` allows us to run a command as the user `bandit27`.

4. Run`./bandit27-do ls /etc/bandit_pass`. What other commands you could run as the user `bandit27`?



### Hints 27 -> 28

Now it's time for some git magic.

1. To clone the repo you will need to be at a directory where you can write.

2. `/tmp` seems like a good place to put your files.

3. Perhaps `git clone` can help you.

4. `README` is asking you to read it, so be it!




### Hints 28 -> 29

More git...

1. Clone the repo the same way you did in the last challenge

2. Nothing interesting? Try to figure out how `commits` in git work. How can you list them?

3. Take a look at the `git log` command.

4. One of the commit messages tells you something interesting, doesn't it?

5. Take a look at `git checkout`.

6. Checkout to another commit and take a look at the files. Have they changed?

7. If you are reading this hint you probably need to move one commit back.



### Hints 29 -> 30

More git? Seriously?!

1. Nothing interesting huh? Did you check the other `git branch`es?

2. Still nothing? Sure you checked `--all` of them?

3. Generally speaking `dev` and `test` branches have unfinished/sensitive work.

4. Can't checkout the branches? Well, it's life. Sometimes you need a little push. Here, however, I think a `pull` would be better-suited.


### Hints 30 -> 31

Even more git, I'm not even surprised anymore.

1. Take a look at the most used git commands and test them here.

2. How do you specify versions on git?

Really not much else to say here. It's fine to see the spoilers if you didn't figure this one out.


### Hints 31 -> 32

Guess what? Git.

1. He told you what to do. Do it!

2. Did you create the right file? It's `key.txt`.

3. Commit your changes.

4. Nothing to commit? Remember the file has to be in the staging area to be considered in a commit.

5. Remember when I said you needed a pull instead of a `git push`?


### Hints 32 -> 33

OMG NOT A GIT CHALLENGE

1. In shell script we can have arguments. Do a little research on `$?`, `$1`, `$2`, etc.

2. What if I told you that the bash is just another shell script when it comes to arguments?

3. There's something I didn't tell you... There is `$0` as well.







You did it! Congratz :)


<!--more-->






## Appendix: Full Spoilers (WARNING)


This section just describes the steps used to obtain the passwords. It doesn't contain explainations on how things work. Use it with responsibility, try to solve the challenges yourself first.


### Spoilers 26 -> 27
Use the file `bandit27-do`, which executes what is passed to it as the user bandit27, to cat `/etc/bandit_pass/bandit27`. Full command is `./bandit27-do cat /etc/bandit_pass/bandit27`.

### Spoilers  27 -> 28
Make a new directory in `/tmp` with `mkdir`, navigate to it using `cd` and clone the git repo (in this case `git clone ssh://bandit27-git@localhost/home/bandit27-git/repo`). The password is in `repo/README`.

### Spoilers 28 -> 29
Make a new directory in `/tmp` with `mkdir`, navigate to it using `cd` and clone the git repo (in this case `git clone ssh://bandit27-git@localhost/home/bandit28-git/repo`). Use `git log` to find a commit where the data leak is present (`186a1038cc54d1358d42d468cdc8e3cc28a93fcb`) then checkout to it (`git checkout 186a1038cc54d1358d42d468cdc8e3cc28a93fcb`). The password is in this commit's version of `/repo/README.md`.

### Spoilers 29 -> 30
Make a new directory in `/tmp` with `mkdir`, navigate to it using `cd` and clone the git repo (in this case `git clone ssh://bandit27-git@localhost/home/bandit29-git/repo`). List all remote branches with `git branch --all`, fetch the `dev` branch (`git fetch origin dev`), pull it (`git pull dev`) and checkout to it (`git checkout dev`). The password is in `repo/README.md`.

### Spoilers 30 -> 31
Make a new directory in `/tmp` with `mkdir`, navigate to it using `cd` and clone the git repo (in this case `git clone ssh://bandit27-git@localhost/home/bandit30-git/repo`). List tags (`git tag`). The password is in the `secret` tag's annotation (`git show secret`).

### Spoilers 31 -> 32
Make a new directory in `/tmp` with `mkdir`, navigate to it using `cd` and clone the git repo (in this case `git clone ssh://bandit27-git@localhost/home/bandit31-git/repo`). Create the file `key.txt` inside the repository (`touch key.txt`) and fill it with the text "May I come in?" (`echo "May I come in?" > key.txt`). Add the file to the staging area, the area that goes into the next commit. As all the files ending with `.txt` are being igored by `gitignore` we need either to remove that line from `gitignore` or to force add the file using `git add -f key.txt`. Commit (`git commit -m "Any message really"`) and push (`git push`). The password is returned after the push is completed.

### Spoilers 32 -> 33
Type `$0` to obtain the regular (not the uppercase) shell. In the regular shell just `cat /etc/bandit_pass/bandit33`

